/*!build time : 2014-04-30 6:13:04 PM*/
KISSY.add("gallery/order/1.0/index",function(a,b,c){function d(a){var b=this;d.superclass.constructor.call(b,a)}var e="ks-order-ascending",f="ks-order-descending",g="asc",h="desc",i="ks-order-activated-ascending",j="ks-order-activated-descending",k="ks-order-activated",l="ks-order-trigger",m=".",n=" ";return a.extend(d,c,{initializer:function(){var b=this;(b.get("node")||b.get("srcNode"))&&b.get("data")||a.log("order::initialize failed!"),b.render(),b.bind()},destructor:function(){},render:function(){var b=this,c=b.get("data");b.items=[],b.wrapper=a.one(b.get("tpl")),a.each(c,function(c,d){"undefined"==typeof c.isTwoWay&&(c.isTwoWay=!0);var g=a.substitute(c.itemCellTpl||b.get("itemCellTpl"),c),h=a.substitute(c.itemTpl||b.get("itemTpl"),{index:d}),l=a.one(g),m=a.one(h);m.append(l),c.activated&&(m.addClass(k),b.curNode=m,b.curIndex=d),c.isTwoWay&&(l.append('<i class="icon">&nbsp;</i>'),m.addClass(c.activated?"asc"===c.default?i:j:"asc"===c.default?e:f)),b.items.push(m),b.wrapper.append(m)}),b.get("node").append(b.wrapper)},bind:function(){var b=this,c=b.get("data");b.wrapper.delegate("click",m+l,function(d){d.preventDefault();var l=a.one(d.currentTarget),m=l.parent("li"),o=m.attr("data-index"),p="none",q="none";m.hasClass(k)?c[o].isTwoWay&&(m.hasClass(i)?(p=g,q=h,m.replaceClass(i,j)):(p=h,q=g,m.replaceClass(j,i))):(b.curNode.removeClass(k+n+j+n+i),b.curNode.addClass(c[b.curIndex].default===g?e:f),m.hasClass(e)?(p=g,q=h,m.replaceClass(e,i)):m.hasClass(f)&&(p=h,q=g,m.replaceClass(f,j)),m.addClass(k)),b.fire("orderChange",{oldEl:b.curNode,oldData:c[b.curIndex],newEl:m,newData:c[o],oldOrder:p,newOrder:q}),b.curNode=m,b.curIndex=o})},getCurrentNode:function(){return this.curNode},getCurrentData:function(){return this.get("data")[this.curIndex]},getCurrentOrder:function(){return this.curOrder}},{ATTRS:{node:{setter:function(b){return a.one(b)},validator:function(b){return!!a.one(b)}},srcNode:{setter:function(b){return a.one(b)},validator:function(b){return!!a.one(b)}},data:{validator:function(b){return b&&a.isArray(b)}},tpl:{value:'<ul class="ks-order-wrapper"></ul>',readonly:!0},itemTpl:{value:'<li class="ks-order-item" data-index="{index}"></li>',readonly:!0},itemCellTpl:{value:'<a href="javascript:;" class="ks-order-trigger">{displayName}</a>'}}}),d},{requires:["node","base"]}),KISSY.add("gallery/order/1.0/mini",function(a,b){return b},{requires:["./index"]});